<!DOCTYPE html>
<html>
<head>
    <title>HSSS - Stats</title>

    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
    <link href="http://oss.maxcdn.com/clusterize.js/0.15.0/clusterize.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
    <div class="navbar-fixed">
        <nav>
          <div class="nav-wrapper">
            <a href="#!" class="brand-logo center">He Said She Said - Stats</a>
            <ul id="nav-mobile" class="right hide-on-med-and-dowm" style="height:inherit">
                <li style="height:inherit">
                    <a href="https://github.com/ghmeier/hesaidshesaid" style="height:inherit">
                        Find it on Github.
                    </a>
                </li>
            </ul>
          </div>
        </nav>
    </div>
    <div class="container">
    </div>
    <a id="refresh" class="waves-effect waves-light btn-large" style="position:fixed;bottom:45px;right:24px;"><i class="material-icons left">replay</i>Refresh</a>
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

    <script src="http://underscorejs.org/underscore-min.js"></script>
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
    <script src="http://code.highcharts.com/highcharts.js"></script>


<script src = "https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

<script src = "https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>

<script>
$(document).ready(function(){
	getAuth(function(){
		console.log("authors gotten");
	});
	getSub();
	getSent();
	console.log("end");
});


var getAuth = function(callback){
	$.get("authors",function(data){
		var mAuthCount = data.classifier.docCount.male;
		var fAuthCount = data.classifier.docCount.female;
		
		console.log(mAuthCount,fAuthCount);
		callback();
	});
};

var getSub = function(callback){
	$.get("subjects",function(data){
		var mSub = data.classifier.docCount.male_male + data.classifier.docCount.female_male;
		var fSub = data.classifier.docCount.male_female + data.classifier.docCount.female_female;
		console.log(mSub,fSub);
		if(callback)
			callback();
	});
}

var getSent = function(callback){
	$.get("sentiments",function(data){
	
	var keys = {};
	var dist = {};
	keys = Object.keys(data.classifier.wordFrequencyCount);
		for(i=0;i<keys.length;i++){
			dist[keys[i]] = _.chain(data.classifier.wordFrequencyCount[keys[i]]).pairs().sortBy(function(pair){return pair[1];}).value().splice(7,3);
		}
	console.log(keys,dist)
	if(callback)
		callback();
	});
}

</script>

</body>
</html>